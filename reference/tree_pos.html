<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Position and Height of a Tree from Point Cloud — tree_pos • TreeCompR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Position and Height of a Tree from Point Cloud — tree_pos"><meta name="description" content="Compute the stem base position, metroid of the crown projected
area and the stem height of a tree"><meta property="og:description" content="Compute the stem base position, metroid of the crown projected
area and the stem height of a tree"><meta property="og:image" content="https://juliarieder.github.io/TreeCompR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeCompR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/TreeCompR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ALS_inventory.html">ALS competition workflow</a></li>
    <li><a class="dropdown-item" href="../articles/competition-inventory.html">Quantifying competition from inventory data</a></li>
    <li><a class="dropdown-item" href="../articles/competition-pointcloud.html">Quantifying competition from point cloud data</a></li>
    <li><a class="dropdown-item" href="../articles/TLS_inventory.html">TLS competition workflow</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/juliarieder/TreeCompR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Position and Height of a Tree from Point Cloud</h1>
      <small class="dont-index">Source: <a href="https://github.com/juliarieder/TreeCompR/blob/main/R/tree_position_height.R" class="external-link"><code>R/tree_position_height.R</code></a></small>
      <div class="d-none name"><code>tree_pos.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the stem base position, metroid of the crown projected
area and the stem height of a tree</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tree_pos</span><span class="op">(</span><span class="va">tree</span>, z_min <span class="op">=</span> <span class="fl">100L</span>, h_xy <span class="op">=</span> <span class="fl">0.3</span>, res <span class="op">=</span> <span class="fl">0.1</span>, tree_name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>tree_pc or data.frame (x, y, z) of the tree point cloud.
Coordinates have to be in metric system!</p></dd>


<dt id="arg-z-min">z_min<a class="anchor" aria-label="anchor" href="#arg-z-min"></a></dt>
<dd><p>integer of length 1 describing the the minimum number of points
needed in the lowermost 1 voxel depth Z layer to consider it part of the
tree. Default is 100. If changing the voxel resolution (res) from the
default value of 0.1, different settings may be necessary.</p></dd>


<dt id="arg-h-xy">h_xy<a class="anchor" aria-label="anchor" href="#arg-h-xy"></a></dt>
<dd><p>numeric of length 1 describing the height range in m over the
stem base over which the x and y positions are used to calculate the x and
y coordinates of the stem base. Default is 0.3 m.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>res numeric of length 1 defining the resolution of a voxel as
passed on to <code><a href="https://rdrr.io/pkg/VoxR/man/vox.html" class="external-link">VoxR::vox()</a></code>. Defaults to 0.1 (10 cm voxel size).</p></dd>


<dt id="arg-tree-name">tree_name<a class="anchor" aria-label="anchor" href="#arg-tree-name"></a></dt>
<dd><p>character vector of length 1 with the name of the tree as
returned with the output object. Defaults to NULL (take name from <code>tree</code>
argument).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>object of class "tree_pos" containing the following components:</p><ul><li><p><code>base_pos</code> numeric vector of length 3 with the x, y, z
coordinates of the tree base position.</p></li>
<li><p><code>crown_pos</code> numeric vector of length 3 with the x, and y
coordinates of the central point of the crown projected
area and the z position of the stem base identified as
above.</p></li>
<li><p><code>height</code> numeric of length one containing the tree height in m.</p></li>
<li><p><code>cpa_m2</code> numeric of length one containing the crown projected area
in m².</p></li>
<li><p><code>cpa_xy</code> <code>data.table</code> with the x and y positions of the
crown.</p></li>
<li><p><code>tree_name</code> name of the object used as the "tree" argument, or
name specified by the user.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Calculates the stem base position, metroid of the crown projected
area and height of a tree from a data.frame with  a point cloud as created
with <code><a href="read_pc.html">read_pc()</a></code>.</p>
<p>For the <em>stem base</em>, the z position is taken as the z position of the first
voxel layer containing at least z_min points of the point cloud (the
standard value is 100). This is done to avoid outlying values affecting the
calculated stem base height and should usually be consistent with taking
the median z value of the lowermost group of points, but with a lower
sensitivity to outliers.
The x and y position of the stem base are calculated as the median of the
voxelized x and y coordinates of all voxels in the first h_xy m over the
stem base (on default: first 0.3 m - values that are too low should be
avoided here as the stem shape may be irregular close to the ground).</p>
<p>The <em>crown projected area</em> is computed as the projected area of all voxels
belonging to the tree.</p>
<p>The <em>central point of the crown projected area</em> is computed as the median
of the x and y position of the projected area of the tree.</p>
<p>The <em>height</em> is based on difference between the z value of the highest
voxel belonging to the tree over and the z value identified for the stem
base.</p>
<p>The calculation is done on voxels to ensure consistency with downstream
analyses and to reduce bias caused by inhomogeneous point densities on
different sides of the stem.</p>
<p>In our opinion, in most cases it makes more sense to calculate competition
indices based on the central point of the tree crown than based on the
stem base because for strongly inclined trees a cylinder constructed around
its base may contain no voxels of the crown of the central tree at all.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_pc.html">read_pc()</a></code> for details on reading point clouds,
<code><a href="compete_pc.html">compete_pc()</a></code> for computing tree competition from point cloud objects.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Read the tree point cloud</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">read_tree</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"path/to/tree_point_cloud.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get the position of this tree (x, y, z)</span></span></span>
<span class="r-in"><span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu">tree_pos</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pos</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julia S. Rieder, Roman M. Link.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

