<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Define target trees in forest inventory data — define_target • TreeCompR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define target trees in forest inventory data — define_target"><meta name="description" content="define_target() takes a forest_inv dataset and returns an updated forest
inventory with highlighted target trees for analysis with compete_inv.
Target trees can be manually specified by tree ID, imported from a different
dataset or identified automatically by excluding edge trees from their
coordinates."><meta property="og:description" content="define_target() takes a forest_inv dataset and returns an updated forest
inventory with highlighted target trees for analysis with compete_inv.
Target trees can be manually specified by tree ID, imported from a different
dataset or identified automatically by excluding edge trees from their
coordinates."><meta property="og:image" content="https://juliarieder.github.io/TreeCompR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TreeCompR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/TreeCompR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ALS_inventory.html">ALS competition workflow</a></li>
    <li><a class="dropdown-item" href="../articles/competition-inventory.html">Quantifying competition from inventory data</a></li>
    <li><a class="dropdown-item" href="../articles/competition-pointcloud.html">Quantifying competition from point cloud data</a></li>
    <li><a class="dropdown-item" href="../articles/TLS_inventory.html">TLS competition workflow</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/juliarieder/TreeCompR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Define target trees in forest inventory data</h1>
      <small class="dont-index">Source: <a href="https://github.com/juliarieder/TreeCompR/blob/development/R/define_target.R" class="external-link"><code>R/define_target.R</code></a></small>
      <div class="d-none name"><code>define_target.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>define_target()</code> takes a <code>forest_inv</code> dataset and returns an updated forest
inventory with highlighted target trees for analysis with <code>compete_inv</code>.
Target trees can be manually specified by tree ID, imported from a different
dataset or identified automatically by excluding edge trees from their
coordinates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">define_target</span><span class="op">(</span></span>
<span>  <span class="va">inv</span>,</span>
<span>  target_source <span class="op">=</span> <span class="st">"buff_edge"</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  crop_to_target <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-inv">inv<a class="anchor" aria-label="anchor" href="#arg-inv"></a></dt>
<dd><p>object of class <code>forest_inv</code> as created with <code><a href="read_inv.html">read_inv()</a></code>.</p></dd>


<dt id="arg-target-source">target_source<a class="anchor" aria-label="anchor" href="#arg-target-source"></a></dt>
<dd><p>one of the following:</p><ol><li><p>a vector of class <code>"character"</code> containing the tree IDs identifying the
target trees in the  same format as in the <code>id</code> column of <code>inv</code>.</p></li>
<li><p>a vector of class <code>logical</code> specifying for each row of <code>inv</code> whether
the corresponding tree is a target tree.</p></li>
<li><p>another object of class <code>forest_inv</code> containing the coordinates of the
target trees. In this case, the coordinates are matched against the
coordinates in <code>inv</code> and IDs may differ (useful e.g. when target trees
are defined based on GPS coordinates and matched against an airborne laser
scanning dataset).</p></li>
<li><p>a character vector of length 1 defining the method by which the target
trees should be determined. Allowed are <code>"buff_edge"</code> for excluding all
trees that are at least one search radius from the forest edge,
<code>"exclude_edge"</code> for only excluding edge trees or <code>"all_trees"</code> for
including all trees of the dataset (which is hardly ever a good idea unless
all trees in the entire forest are in the dataset). The standard is
<code>"buff_edge"</code>. See below for details.</p></li>
</ol></dd>


<dt id="arg-radius">radius<a class="anchor" aria-label="anchor" href="#arg-radius"></a></dt>
<dd><p>numeric of length 1, Search radius (in m) around target tree
wherein all neighboring trees are classified as competitors. Only used if
<code>target_source</code> is <code>"buff_edge"</code>, <code>"exclude_edge"</code> or of type <code>forest_inv</code>.
Defaults to 10.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric. Only used when <code>target_source</code> is an inventory with a
second set of coordinates. Tolerance for the match between tree coordinates
in the forest inventory and target datasets if specified as a second set of
coordinates. If a field measurements (e.g. based on GPS) are used to
identify target trees and the full inventory is from a different data
source (e.g. ALS data), a higher tolerance value may be required to
identify the trees depending on the measurement accuracy. Values of 0 mean
exact matching. Defaults to 1 (match within a 1 m buffer).</p></dd>


<dt id="arg-crop-to-target">crop_to_target<a class="anchor" aria-label="anchor" href="#arg-crop-to-target"></a></dt>
<dd><p>logical of length 1. Should the inventory be limited
to the extent of the target coordinates? If TRUE, the extent of <code>inv</code> will
be cropped to the extent of <code>forest_inv</code> \(\pm\) <code>radius + tol</code> to
reduce computational load in later steps. Defaults to FALSE.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical of length 1. Should information about progress be
printed? Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>object of class <code>target_inv</code> (inherits from <code>forest_inv</code>): a
modified data.table with the x and y coordinates of the tree, a unique tree
identifier (<code>id</code>), at least one of tree diameter at breast height (<code>dbh</code>,
in cm) and tree height (<code>height</code>,in m) and a new logical column <code>target</code>
specifying whether a tree is defined as a target tree.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>define_target()</code> can be used to select target trees from a
<code>forest_inv</code> object either by manually specifying them as a character
vector with tree IDs, as a logical vector that specifies for each tree in
the inventory whether or not it is treated as a target tree, a separate
set of (approximate) coordinates of the target trees that is matched
against the original inventory, or a character string describing how to
choose the target trees based on their spatial arrangement.</p>
<p>When the target is defined by a second set of coordinates, these
coordinates will then be matched against the inventory data. IDs are
ignored in this case and  matching is based only on the closest trees with
in a buffer of <code>tol</code> m  (the default is <code>tol = 1</code>: matching within 1 m).
All further size-related variables in the second set of coordinates are
ignored as well to make sure that in later steps competition indices will
be computed with data from the same data source.
When different target trees are matched to the same tree in the inventory,
or when two trees in the inventory have the same distance to a target
tree within 5 cm, the function fails with an error. If two inventory trees
are within the specified tolerance and the difference is larger, the
function proceeds with a warning.
The intended use case for determining target trees in this way is to
compute tree competition from ALS data based on GPS coordinates of single
trees in studies that are based on single tree rather than plot-level
data, which creates a need for different data sources to compute
competition.</p>
<p>The methods <code>target_source = "buff_edge"</code> and
<code>target_source = "exclude_edge"</code> are intended for cases where it is desired
to compute valid competition indices for as many trees as possible while
avoiding edge effects. While it is possible to designate all trees in the
dataset as target tree by setting <code>target_source = "all_trees"</code>, this is
not a good idea in the majority of cases: unless your dataset contains all
trees in the forest (possible for ALS-based data, but very unlikely for
data based on classical inventory methods and TLS/MLS), there will be very
extreme edge effects at the outer edge of the extent of the covered trees
resulting in strongly underestimated competition for edge trees.
<code>target_source = "buff_edge"</code> excludes all trees who are less than one
search radius (<code>radius</code>) away from the plot border (approximated by a
concave hull based on <code><a href="https://joelgombin.github.io/concaveman/reference/concaveman.html" class="external-link">concaveman::concaveman()</a></code>) and hence guarantees to
only include trees that can obtain valid competition index values for that
search radius. <code>target_source = "exclude_edge"</code> only removes the edge trees
and hence is less restrictive, but more prone to edge effects.</p>
<p>Do not use <code>target_source = "all_trees"</code> unless you know exactly what you
are doing!</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_inv.html">read_inv()</a></code> to read forest inventory data,
<code><a href="compete_inv.html">compete_inv()</a></code> for computing tree competition from inventory data,
<code><a href="plot_target.html">plot_target()</a></code> to plot target tree positions in <code>target_inv</code> and
<code>compete_inv</code> objects.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># read inventory</span></span></span>
<span class="r-in"><span><span class="va">inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_inv.html">read_inv</a></span><span class="op">(</span><span class="st">"path/to/invtable.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#or just validate your already loaded inventory data</span></span></span>
<span class="r-in"><span><span class="co">#e.g.extracted from lidR package</span></span></span>
<span class="r-in"><span><span class="va">inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_inv.html">read_inv</a></span><span class="op">(</span><span class="va">inventory</span>, height <span class="op">=</span> <span class="va">Z</span>, height_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># or from itcSegment (itcLiDARallo)</span></span></span>
<span class="r-in"><span><span class="va">inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_inv.html">read_inv</a></span><span class="op">(</span><span class="va">inventory</span>, height <span class="op">=</span> <span class="va">Height_m</span>, height_unit <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># target trees defined by a buffer around the plot edges</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu">define_target</span><span class="op">(</span><span class="va">inv</span>, target_source <span class="op">=</span> <span class="st">"buff_edge"</span>, radius <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#or if your trees are definitely at a forest edge</span></span></span>
<span class="r-in"><span><span class="co">#(and not just at the edge of your dataset) you can include all trees</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu">define_target</span><span class="op">(</span><span class="va">inv</span>, target_source <span class="op">=</span> <span class="st">"all_trees"</span>, radius <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julia S. Rieder, Roman M. Link.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

